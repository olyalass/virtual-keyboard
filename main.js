(()=>{"use strict";class t{constructor(){this.container=document.createElement("div"),this.input=document.createElement("textarea"),this.input.setAttribute("spellcheck",!1),this.input.classList.add("textarea__input"),this.container.append(this.input),this.cursor=this.input.selectionStart,this.input.addEventListener("click",(()=>{this.cursor=this.input.selectionStart}))}addChar(t,e,n){if(t.key){let i;i="eng"===n?e&&t.onShift?t.onShift:t.key:e?t.langOnShift?t.langOnShift:t.onShift?t.onShift:t.lang?t.land:t.key:t.lang?t.lang:t.key,this.input.value=this.input.value.slice(0,this.cursor)+i+this.input.value.slice(this.cursor),this.cursor+=1}else"ArrowUp"===t.code&&this.setCursorUp(),"ArrowDown"===t.code&&this.setCursorDown(),"Backspace"===t.code?(this.input.value=this.input.value.slice(0,this.cursor-1)+this.input.value.slice(this.cursor),this.cursor-=1):"Delete"===t.code?this.input.value=this.input.value.slice(0,this.cursor)+this.input.value.slice(this.cursor+1):"ArrowLeft"===t.code?this.moveCursor("left"):"ArrowRight"===t.code&&this.moveCursor("right");this.setFocus()}setCursorUp(){const t=this.input.value.lastIndexOf("\n",this.cursor-1),e=this.cursor-t;if(e>=95||-1===t&&this.input.value.length>95)this.cursor-=95;else if(-1===t)this.cursor=0;else{const n=this.input.value.lastIndexOf("\n",t-1),i=t-n;this.cursor=i<e?t:n+e}this.input.setSelectionRange(this.cursor,this.cursor)}setCursorDown(){const t=this.input.value.lastIndexOf("\n",this.cursor-1),e=this.cursor-t,n=this.input.value.indexOf("\n",t+1);if(e>=95||-1===t&&this.input.value.length>95)this.cursor+=95;else if(-1===n)this.cursor=this.input.value.length;else{let t=this.input.value.indexOf("\n",n+1);-1===t&&(t=this.input.value.length);const i=t-n;this.cursor=i<e?n+i:n+e}this.input.setSelectionRange(this.cursor,this.cursor)}setFocus(){this.input.focus(),this.input.selectionStart=this.cursor,this.input.selectionEnd=this.cursor}moveCursor(t){"left"===t?this.cursor-=1:this.cursor+=1,this.setFocus()}}class e{constructor(t){switch(this.obj=t,this.container=document.createElement("div"),this.container.classList.add("key__container"),this.face=document.createElement("div"),this.face.classList.add("key__face"),this.text=document.createElement("p"),this.text.classList.add("key__text"),"char"===t.type?this.text.textContent=t.key:void 0!==t.name?this.text.textContent=t.name:this.text.textContent=t.code,this.face.append(this.text),t.size){case 2:this.container.classList.add("key__container_s");break;case 3:this.container.classList.add("key__container_event_m");break;case 4:this.container.classList.add("key__container_event_l");break;case 5:this.container.classList.add("key__container_event_xl");break;case 1:this.container.classList.add("key__container_xs")}this.container.append(this.face),"event"===t.type&&(t.isArrow?this.container.classList.add("key__container_arrow"):this.container.classList.add("key__container_event")),this.container.addEventListener("click",(()=>{"CapsLock"===t.code&&this.setOnMode();const e=new CustomEvent("custom-key",{bubbles:!0,detail:{obj:t,isCaps:this.isCaps}});this.container.dispatchEvent(e)})),this.container.addEventListener("mousedown",(()=>{this.container.classList.add("key__container_clicked"),this.container.classList.add("key__face_clicked"),this.toggleShift(t)})),this.container.addEventListener("mouseup",(()=>{this.toggleShift(t),setTimeout((()=>{this.container.classList.remove("key__container_clicked"),this.container.classList.remove("key__face_clicked")}),100)}))}setOnMode(){this.face.classList.toggle("key__face_on"),this.isCaps?this.isCaps=!1:this.isCaps=!0}toggleShift(t){if("ShiftLeft"===t.code){const e=new CustomEvent("shift-down",{bubbles:!0,detail:{obj:t}});this.container.dispatchEvent(e)}}}const n=JSON.parse('[{"code":"Backquote","key":"`","type":"char","onShift":"~","lang":"¨","langOnShift":"¸"},{"code":"Digit1","key":"1","type":"char","onShift":"!"},{"code":"Digit2","key":"2","type":"char","onShift":"@","langOnShift":"\\""},{"code":"Digit3","key":"3","type":"char","onShift":"#"},{"code":"Digit4","key":"4","type":"char","onShift":"$"},{"code":"Digit5","key":"5","type":"char","onShift":"%"},{"code":"Digit6","key":"6","type":"char","onShift":"^","langOnShift":"&"},{"code":"Digit7","key":"7","type":"char","onShift":"&","langOnShift":"/"},{"code":"Digit8","key":"8","type":"char","onShift":"*","langOnShift":"("},{"code":"Digit9","key":"9","type":"char","onShift":"(","langOnShift":")"},{"code":"Digit0","key":"0","type":"char","onShift":")","langOnShift":"="},{"code":"Minus","key":"-","type":"char","onShift":"_","lang":"\'","langOnShift":"?"},{"code":"Equal","key":"=","type":"char","onShift":"+","lang":"+","langOnShift":"*"},{"code":"Backspace","type":"event","size":3,"name":"⟵"},{"code":"Tab","type":"event","key":"\\t","size":2},{"code":"KeyQ","key":"q","type":"char","onShift":"Q"},{"code":"KeyW","key":"w","type":"char","onShift":"W"},{"code":"KeyE","key":"e","type":"char","onShift":"E"},{"code":"KeyR","key":"r","type":"char","onShift":"R"},{"code":"KeyT","key":"t","type":"char","onShift":"T"},{"code":"KeyY","key":"y","type":"char","onShift":"Y","lang":"z","langOnShift":"Z"},{"code":"KeyU","key":"u","type":"char","onShift":"U"},{"code":"KeyI","key":"i","type":"char","onShift":"I"},{"code":"KeyO","key":"o","type":"char","onShift":"O"},{"code":"KeyP","key":"p","type":"char","onShift":"P"},{"code":"BracketLeft","key":"[","type":"char","onShift":"{","lang":"š","langOnShift":"Š"},{"code":"BracketRight","key":"]","type":"char","onShift":"}","lang":"đ","langOnShift":"Đ"},{"code":"Backslash","key":"\\\\","type":"char","onShift":"|","lang":"ž","langOnShift":"Ž","size":2},{"code":"CapsLock","type":"event","size":3},{"code":"KeyA","key":"a","type":"char","onShift":"A"},{"code":"KeyS","key":"s","type":"char","onShift":"S"},{"code":"KeyD","key":"d","type":"char","onShift":"D"},{"code":"KeyF","key":"f","type":"char","onShift":"F"},{"code":"KeyG","key":"g","type":"char","onShift":"G"},{"code":"KeyH","key":"h","type":"char","onShift":"H"},{"code":"KeyJ","key":"j","type":"char","onShift":"J"},{"code":"KeyK","key":"k","type":"char","onShift":"K"},{"code":"KeyL","key":"l","type":"char","onShift":"L"},{"code":"Semicolon","key":";","type":"char","onShift":":","lang":"č","langOnShift":"Č"},{"code":"Quote","key":"\'","type":"char","onShift":"\\"","lang":"č","langOnShift":"Č"},{"code":"Enter","type":"event","key":"\\n","size":3},{"code":"ShiftLeft","type":"event","name":"shift","size":4},{"code":"KeyZ","key":"z","type":"char","onShift":"Z","lang":"y","langOnShift":"Y"},{"code":"KeyX","key":"x","type":"char","onShift":"X"},{"code":"KeyC","key":"c","type":"char","onShift":"C"},{"code":"KeyV","key":"v","type":"char","onShift":"V"},{"code":"KeyB","key":"b","type":"char","onShift":"B"},{"code":"KeyN","key":"n","type":"char","onShift":"N"},{"code":"KeyM","key":"m","type":"char","onShift":"M"},{"code":"Comma","key":",","type":"char","onShift":"<","langOnShift":";"},{"code":"Period","key":".","type":"char","onShift":">","langOnShift":":"},{"code":"Slash","key":"/","type":"char","onShift":"?","lang":"-","langOnShift":"_"},{"code":"ArrowUp","type":"event","name":"⇧","isArrow":true},{"code":"Delete","type":"event","name":"del","size":2},{"code":"ControlLeft","type":"event","name":"ctrl","size":1},{"code":"AltLeft","type":"event","name":"alt","size":1},{"code":"MetaLeft","type":"event","name":"⌘","size":1},{"code":"Space","type":"event","key":" ","name":"","size":5},{"code":"MetaRight","type":"event","name":"⌘","size":1},{"code":"ArrowLeft","type":"event","name":"⇦","isArrow":true},{"code":"ArrowDown","type":"event","name":"⇩","isArrow":true},{"code":"ArrowRight","type":"event","name":"⇨","isArrow":true}]');class i{constructor(){this.charKeysArr=[],this.keysArr=[],this.container=document.createElement("div"),this.container.classList.add("keyboard__container"),n.forEach((t=>{const n=new e(t);"char"===t.type&&this.charKeysArr.push(n),this.keysArr.push(n),this.container.append(n.container)}));const t=localStorage.getItem("lang");"eng"!==t&&this.changeNames(!1,t)}changeNames(t,e){this.charKeysArr.forEach((n=>{"eng"===e?t&&n.obj.onShift?n.text.textContent=n.obj.onShift:n.text.textContent=n.obj.key:t?n.obj.langOnShift?n.text.textContent=n.obj.langOnShift:n.text.textContent=n.obj.onShift:n.obj.lang?n.text.textContent=n.obj.lang:n.text.textContent=n.obj.key}))}}class s{constructor(){this.container=document.createElement("aside"),this.container.classList.add("hints__container");const t=document.createElement("h2");t.classList.add("hints__title"),t.textContent="Hot Keys",this.list=document.createElement("ul"),this.list.textContent="Change language:",this.list.classList.add("hints__list"),this.createListItem("For Mac: ","Control + ⌘ Command"),this.createListItem("For Windows: ","⇧ Shift + ⎵ Space");const e=document.createElement("p");e.classList.add("hints__text"),e.textContent="Keyboard was made on Mac OS",this.container.append(t,this.list,e)}createListItem(t,e){const n=document.createElement("li");n.classList.add("hints__item");const i=document.createElement("span");i.classList.add("hints__span"),i.textContent=t;const s=document.createElement("p");s.textContent=e,n.append(s),s.prepend(i),this.list.append(n)}}class a{constructor(){this.item=document.createElement("header"),this.item.classList.add("header");const t=document.createElement("h1");t.classList.add("header__title"),t.textContent="Virtual Keyboard";const e=document.createElement("p");e.classList.add("header__note"),e.textContent="Info";const n=new s,i=document.createElement("div");i.classList.add("header__cover"),this.item.append(t,e,n.container,i),e.addEventListener("click",(()=>{n.container.classList.toggle("hints__container_open")}))}}class o{constructor(){this.item=document.createElement("footer"),this.item.classList.add("footer");const t=document.createElement("p");t.classList.add("footer__text"),t.textContent="Layout:  ",this.eng=document.createElement("span"),this.eng.classList.add("footer__span"),this.eng.textContent="eng ",this.croat=document.createElement("span"),this.croat.classList.add("footer__span"),this.croat.textContent="HR/SRB",t.append(this.eng,this.croat);const e=localStorage.getItem("lang");this.lang=e||"eng","eng"!==this.lang?this.croat.classList.add("footer__span_selected"):this.eng.classList.add("footer__span_selected");const n=document.createElement("p");n.classList.add("footer__text","footer__link"),n.textContent="2023",this.item.append(t,n)}onLangChange(t){this.lang=t,this.croat.classList.toggle("footer__span_selected"),this.eng.classList.toggle("footer__span_selected")}}const c=document.querySelector("body"),h=new class{constructor(){this.container=document.createElement("div"),this.container.classList.add("app");const e=localStorage.getItem("lang");this.lang=e||"eng";const n=new a;this.footer=new o,this.textarea=new t,this.keyboard=new i,this.container.append(n.item,this.textarea.container,this.keyboard.container,this.footer.item),this.container.addEventListener("custom-key",(t=>{this.onVirtualKey(t.detail.isCaps,t.detail.obj),this.textarea.input.focus()})),this.container.addEventListener("shift-down",(t=>{this.isCaps=!this.isCaps,this.keyboard.changeNames(this.isCaps,this.lang),this.textarea.input.focus()})),document.addEventListener("keydown",(t=>{t.preventDefault();let e=this.keyboard.keysArr.find((e=>e.obj.code===t.code));"ShiftRight"===t.code&&(e=this.keyboard.keysArr.find((t=>"ShiftLeft"===t.obj.code))),e&&(e.container.classList.add("key__container_clicked"),t.ctrlKey&&t.metaKey||t.shiftKey&&"Space"===t.code?(t.preventDefault(),this.changeLang()):t.key&&(t.preventDefault(),this.onVirtualKey(e.isCaps,e.obj)),"CapsLock"===t.code&&(e.container.click(),this.onVirtualKey(!0,e.obj)),"ShiftLeft"!==t.code&&"ShiftRight"!==t.code||(this.isCaps?this.onVirtualKey(!1,e.obj):this.onVirtualKey(!0,e.obj)))})),document.addEventListener("keyup",(t=>{t.preventDefault();let e=this.keyboard.keysArr.find((e=>e.obj.code===t.code));"ShiftRight"===t.code&&(e=this.keyboard.keysArr.find((t=>"ShiftLeft"===t.obj.code))),e&&(e.container.classList.remove("key__container_clicked"),"CapsLock"===t.code&&(e.container.click(),this.onVirtualKey(!1,e.obj)),"ShiftLeft"!==t.code&&"ShiftRight"!==t.code||(this.isCaps?this.onVirtualKey(!1,e.obj):this.onVirtualKey(!0,e.obj)))}))}changeLang(){"eng"===this.lang?this.lang="hr":this.lang="eng",this.footer.onLangChange(this.lang),this.keyboard.changeNames(this.isCaps,this.lang),localStorage.setItem("lang",this.lang)}onVirtualKey(t,e){void 0!==t&&(this.isCaps=t,this.keyboard.changeNames(this.isCaps,this.lang)),this.textarea.addChar(e,this.isCaps,this.lang)}};c.append(h.container)})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsIm1hcHBpbmdzIjoibUJBRWUsTUFBTUEsRUFDbkJDLGNBQ0VDLEtBQUtDLFVBQVlDLFNBQVNDLGNBQWMsT0FDeENILEtBQUtJLE1BQVFGLFNBQVNDLGNBQWMsWUFDcENILEtBQUtJLE1BQU1DLGFBQWEsY0FBYyxHQUN0Q0wsS0FBS0ksTUFBTUUsVUFBVUMsSUFBSSxtQkFDekJQLEtBQUtDLFVBQVVPLE9BQU9SLEtBQUtJLE9BRTNCSixLQUFLUyxPQUFTVCxLQUFLSSxNQUFNTSxlQUN6QlYsS0FBS0ksTUFBTU8saUJBQWlCLFNBQVMsS0FDbkNYLEtBQUtTLE9BQVNULEtBQUtJLE1BQU1NLGlCQUU3QixDQUVBRSxRQUFRQyxFQUFTQyxFQUFRQyxHQUN2QixHQUFJRixFQUFRRyxJQUFLLENBQ2YsSUFBSUEsRUFHQUEsRUFGUyxRQUFURCxFQUNFRCxHQUFVRCxFQUFRSSxRQUNkSixFQUFRSSxRQUNISixFQUFRRyxJQUNaRixFQUNMRCxFQUFRSyxZQUNKTCxFQUFRSyxZQUNMTCxFQUFRSSxRQUNYSixFQUFRSSxRQUNMSixFQUFRRSxLQUNYRixFQUFRTSxLQUNITixFQUFRRyxJQUNaSCxFQUFRRSxLQUNYRixFQUFRRSxLQUNIRixFQUFRRyxJQUVyQmhCLEtBQUtJLE1BQU1nQixNQUNUcEIsS0FBS0ksTUFBTWdCLE1BQU1DLE1BQU0sRUFBR3JCLEtBQUtTLFFBQy9CTyxFQUNBaEIsS0FBS0ksTUFBTWdCLE1BQU1DLE1BQU1yQixLQUFLUyxRQUM5QlQsS0FBS1MsUUFBVSxDQUNqQixLQUN1QixZQUFqQkksRUFBUVMsTUFDVnRCLEtBQUt1QixjQUVjLGNBQWpCVixFQUFRUyxNQUNWdEIsS0FBS3dCLGdCQUdjLGNBQWpCWCxFQUFRUyxNQUNWdEIsS0FBS0ksTUFBTWdCLE1BQ1RwQixLQUFLSSxNQUFNZ0IsTUFBTUMsTUFBTSxFQUFHckIsS0FBS1MsT0FBUyxHQUN4Q1QsS0FBS0ksTUFBTWdCLE1BQU1DLE1BQU1yQixLQUFLUyxRQUM5QlQsS0FBS1MsUUFBVSxHQUNXLFdBQWpCSSxFQUFRUyxLQUNqQnRCLEtBQUtJLE1BQU1nQixNQUNUcEIsS0FBS0ksTUFBTWdCLE1BQU1DLE1BQU0sRUFBR3JCLEtBQUtTLFFBQy9CVCxLQUFLSSxNQUFNZ0IsTUFBTUMsTUFBTXJCLEtBQUtTLE9BQVMsR0FDYixjQUFqQkksRUFBUVMsS0FDakJ0QixLQUFLeUIsV0FBVyxRQUNVLGVBQWpCWixFQUFRUyxNQUNqQnRCLEtBQUt5QixXQUFXLFNBSXBCekIsS0FBSzBCLFVBQ1AsQ0FFQUgsY0FDRSxNQUFNSSxFQUFZM0IsS0FBS0ksTUFBTWdCLE1BQU1RLFlBQVksS0FBTTVCLEtBQUtTLE9BQVMsR0FDN0RvQixFQUFNN0IsS0FBS1MsT0FBU2tCLEVBQzFCLEdBQUlFLEdBQU8sS0FBc0IsSUFBZkYsR0FBb0IzQixLQUFLSSxNQUFNZ0IsTUFBTVUsT0FBUyxHQUM5RDlCLEtBQUtTLFFBQVUsUUFFZixJQUFtQixJQUFma0IsRUFDRjNCLEtBQUtTLE9BQVMsTUFDVCxDQUNMLE1BQU1zQixFQUFnQi9CLEtBQUtJLE1BQU1nQixNQUFNUSxZQUFZLEtBQU1ELEVBQVksR0FDL0RLLEVBQWlCTCxFQUFZSSxFQUVqQy9CLEtBQUtTLE9BREh1QixFQUFpQkgsRUFDTEYsRUFFQUksRUFBZ0JGLENBRWxDLENBR0Y3QixLQUFLSSxNQUFNNkIsa0JBQWtCakMsS0FBS1MsT0FBUVQsS0FBS1MsT0FDakQsQ0FFQWUsZ0JBQ0UsTUFBTUcsRUFBWTNCLEtBQUtJLE1BQU1nQixNQUFNUSxZQUFZLEtBQU01QixLQUFLUyxPQUFTLEdBQzdEb0IsRUFBTTdCLEtBQUtTLE9BQVNrQixFQUNwQk8sRUFBZ0JsQyxLQUFLSSxNQUFNZ0IsTUFBTWUsUUFBUSxLQUFNUixFQUFZLEdBQ2pFLEdBQUlFLEdBQU8sS0FBc0IsSUFBZkYsR0FBb0IzQixLQUFLSSxNQUFNZ0IsTUFBTVUsT0FBUyxHQUM5RDlCLEtBQUtTLFFBQVUsUUFDVixJQUF1QixJQUFuQnlCLEVBQ1RsQyxLQUFLUyxPQUFTVCxLQUFLSSxNQUFNZ0IsTUFBTVUsV0FDMUIsQ0FDTCxJQUFJTSxFQUFnQnBDLEtBQUtJLE1BQU1nQixNQUFNZSxRQUFRLEtBQU1ELEVBQWdCLElBQzVDLElBQW5CRSxJQUNGQSxFQUFnQnBDLEtBQUtJLE1BQU1nQixNQUFNVSxRQUVuQyxNQUFNTyxFQUFpQkQsRUFBZ0JGLEVBRXJDbEMsS0FBS1MsT0FESDRCLEVBQWlCUixFQUNMSyxFQUFnQkcsRUFFaEJILEVBQWdCTCxDQUVsQyxDQUVBN0IsS0FBS0ksTUFBTTZCLGtCQUFrQmpDLEtBQUtTLE9BQVFULEtBQUtTLE9BQ2pELENBRUFpQixXQUNFMUIsS0FBS0ksTUFBTWtDLFFBQ1h0QyxLQUFLSSxNQUFNTSxlQUFpQlYsS0FBS1MsT0FDakNULEtBQUtJLE1BQU1tQyxhQUFldkMsS0FBS1MsTUFDakMsQ0FFQWdCLFdBQVdlLEdBQ0ksU0FBVEEsRUFDRnhDLEtBQUtTLFFBQVUsRUFDVlQsS0FBS1MsUUFBVSxFQUN0QlQsS0FBSzBCLFVBQ1AsRUMxSGEsTUFBTWUsRUFDbkIxQyxZQUFZMkMsR0FjVixPQWJBMUMsS0FBSzJDLElBQU1ELEVBQ1gxQyxLQUFLQyxVQUFZQyxTQUFTQyxjQUFjLE9BQ3hDSCxLQUFLQyxVQUFVSyxVQUFVQyxJQUFJLGtCQUM3QlAsS0FBSzRDLEtBQU8xQyxTQUFTQyxjQUFjLE9BQ25DSCxLQUFLNEMsS0FBS3RDLFVBQVVDLElBQUksYUFDeEJQLEtBQUs2QyxLQUFPM0MsU0FBU0MsY0FBYyxLQUNuQ0gsS0FBSzZDLEtBQUt2QyxVQUFVQyxJQUFJLGFBQ0osU0FBaEJtQyxFQUFPSSxLQUNUOUMsS0FBSzZDLEtBQUtFLFlBQWNMLEVBQU8xQixTQUNOZ0MsSUFBaEJOLEVBQU9PLEtBQ2hCakQsS0FBSzZDLEtBQUtFLFlBQWNMLEVBQU9PLEtBQzFCakQsS0FBSzZDLEtBQUtFLFlBQWNMLEVBQU9wQixLQUN0Q3RCLEtBQUs0QyxLQUFLcEMsT0FBT1IsS0FBSzZDLE1BQ2RILEVBQU9RLE1BQ2IsS0FBSyxFQUNIbEQsS0FBS0MsVUFBVUssVUFBVUMsSUFBSSxvQkFDN0IsTUFDRixLQUFLLEVBQ0hQLEtBQUtDLFVBQVVLLFVBQVVDLElBQUksMEJBQzdCLE1BQ0YsS0FBSyxFQUNIUCxLQUFLQyxVQUFVSyxVQUFVQyxJQUFJLDBCQUM3QixNQUNGLEtBQUssRUFDSFAsS0FBS0MsVUFBVUssVUFBVUMsSUFBSSwyQkFDN0IsTUFDRixLQUFLLEVBQ0hQLEtBQUtDLFVBQVVLLFVBQVVDLElBQUkscUJBR2pDUCxLQUFLQyxVQUFVTyxPQUFPUixLQUFLNEMsTUFDUCxVQUFoQkYsRUFBT0ksT0FDTEosRUFBT1MsUUFDVG5ELEtBQUtDLFVBQVVLLFVBQVVDLElBQUksd0JBQ3hCUCxLQUFLQyxVQUFVSyxVQUFVQyxJQUFJLHlCQUd0Q1AsS0FBS0MsVUFBVVUsaUJBQWlCLFNBQVMsS0FDbkIsYUFBaEIrQixFQUFPcEIsTUFDVHRCLEtBQUtvRCxZQUVQLE1BQU1DLEVBQVEsSUFBSUMsWUFBWSxhQUFjLENBQzFDQyxTQUFTLEVBQ1RDLE9BQVEsQ0FBRWIsSUFBS0QsRUFBUTVCLE9BQVFkLEtBQUtjLFVBRXRDZCxLQUFLQyxVQUFVd0QsY0FBY0osRUFBSyxJQUdwQ3JELEtBQUtDLFVBQVVVLGlCQUFpQixhQUFhLEtBQzNDWCxLQUFLQyxVQUFVSyxVQUFVQyxJQUFJLDBCQUM3QlAsS0FBS0MsVUFBVUssVUFBVUMsSUFBSSxxQkFDN0JQLEtBQUswRCxZQUFZaEIsRUFBTSxJQUd6QjFDLEtBQUtDLFVBQVVVLGlCQUFpQixXQUFXLEtBQ3pDWCxLQUFLMEQsWUFBWWhCLEdBQ2pCaUIsWUFBVyxLQUNUM0QsS0FBS0MsVUFBVUssVUFBVXNELE9BQU8sMEJBQ2hDNUQsS0FBS0MsVUFBVUssVUFBVXNELE9BQU8sb0JBQW1CLEdBQ2xELElBQUcsR0FFVixDQUVBUixZQUNFcEQsS0FBSzRDLEtBQUt0QyxVQUFVdUQsT0FBTyxnQkFDdkI3RCxLQUFLYyxPQUNQZCxLQUFLYyxRQUFTLEVBQ1RkLEtBQUtjLFFBQVMsQ0FDdkIsQ0FFQTRDLFlBQVloQixHQUNWLEdBQW9CLGNBQWhCQSxFQUFPcEIsS0FBc0IsQ0FDL0IsTUFBTStCLEVBQVEsSUFBSUMsWUFBWSxhQUFjLENBQzFDQyxTQUFTLEVBQ1RDLE9BQVEsQ0FBRWIsSUFBS0QsS0FFakIxQyxLQUFLQyxVQUFVd0QsY0FBY0osRUFDL0IsQ0FDRixFLG0zSEM5RWEsTUFBTVMsRUFDbkIvRCxjQUNFQyxLQUFLK0QsWUFBYyxHQUNuQi9ELEtBQUtnRSxRQUFVLEdBQ2ZoRSxLQUFLQyxVQUFZQyxTQUFTQyxjQUFjLE9BQ3hDSCxLQUFLQyxVQUFVSyxVQUFVQyxJQUFJLHVCQUM3QixXQUFhMEQsSUFDWCxNQUFNakQsRUFBTSxJQUFJeUIsRUFBSXdCLEdBQ0wsU0FBWEEsRUFBRW5CLE1BQ0o5QyxLQUFLK0QsWUFBWUcsS0FBS2xELEdBRXhCaEIsS0FBS2dFLFFBQVFFLEtBQUtsRCxHQUNsQmhCLEtBQUtDLFVBQVVPLE9BQU9RLEVBQUlmLFVBQVMsSUFFckMsTUFBTWMsRUFBT29ELGFBQWFDLFFBQVEsUUFDckIsUUFBVHJELEdBQWdCZixLQUFLcUUsYUFBWSxFQUFPdEQsRUFDOUMsQ0FFQXNELFlBQVl2RCxFQUFRQyxHQUNsQmYsS0FBSytELFlBQVlPLFNBQVFMLElBQ1YsUUFBVGxELEVBQ0VELEdBQVVtRCxFQUFFdEIsSUFBSTFCLFFBQ2xCZ0QsRUFBRXBCLEtBQUtFLFlBQWNrQixFQUFFdEIsSUFBSTFCLFFBQ3RCZ0QsRUFBRXBCLEtBQUtFLFlBQWNrQixFQUFFdEIsSUFBSTNCLElBQ3pCRixFQUNMbUQsRUFBRXRCLElBQUl6QixZQUNSK0MsRUFBRXBCLEtBQUtFLFlBQWNrQixFQUFFdEIsSUFBSXpCLFlBQ3RCK0MsRUFBRXBCLEtBQUtFLFlBQWNrQixFQUFFdEIsSUFBSTFCLFFBQ3pCZ0QsRUFBRXRCLElBQUk1QixLQUNma0QsRUFBRXBCLEtBQUtFLFlBQWNrQixFQUFFdEIsSUFBSTVCLEtBQ3RCa0QsRUFBRXBCLEtBQUtFLFlBQWNrQixFQUFFdEIsSUFBSTNCLE1BRXRDLEVDbENhLE1BQU11RCxFQUNuQnhFLGNBQ0VDLEtBQUtDLFVBQVlDLFNBQVNDLGNBQWMsU0FDeENILEtBQUtDLFVBQVVLLFVBQVVDLElBQUksb0JBQzdCLE1BQU1pRSxFQUFRdEUsU0FBU0MsY0FBYyxNQUNyQ3FFLEVBQU1sRSxVQUFVQyxJQUFJLGdCQUNwQmlFLEVBQU16QixZQUFjLFdBQ3BCL0MsS0FBS3lFLEtBQU92RSxTQUFTQyxjQUFjLE1BQ25DSCxLQUFLeUUsS0FBSzFCLFlBQWMsbUJBQ3hCL0MsS0FBS3lFLEtBQUtuRSxVQUFVQyxJQUFJLGVBQ3hCUCxLQUFLMEUsZUFBZSxZQUFhLHVCQUNqQzFFLEtBQUswRSxlQUFlLGdCQUFpQixxQkFDckMsTUFBTTdCLEVBQU8zQyxTQUFTQyxjQUFjLEtBQ3BDMEMsRUFBS3ZDLFVBQVVDLElBQUksZUFDbkJzQyxFQUFLRSxZQUFjLDhCQUNuQi9DLEtBQUtDLFVBQVVPLE9BQU9nRSxFQUFPeEUsS0FBS3lFLEtBQU01QixFQUMxQyxDQUVBNkIsZUFBZUMsRUFBV0MsR0FDeEIsTUFBTUMsRUFBTzNFLFNBQVNDLGNBQWMsTUFDcEMwRSxFQUFLdkUsVUFBVUMsSUFBSSxlQUNuQixNQUFNdUUsRUFBTzVFLFNBQVNDLGNBQWMsUUFDcEMyRSxFQUFLeEUsVUFBVUMsSUFBSSxlQUNuQnVFLEVBQUsvQixZQUFjNEIsRUFDbkIsTUFBTTlCLEVBQU8zQyxTQUFTQyxjQUFjLEtBQ3BDMEMsRUFBS0UsWUFBYzZCLEVBQ25CQyxFQUFLckUsT0FBT3FDLEdBQ1pBLEVBQUtrQyxRQUFRRCxHQUNiOUUsS0FBS3lFLEtBQUtqRSxPQUFPcUUsRUFDbkIsRUM1QmEsTUFBTUcsRUFDbkJqRixjQUNFQyxLQUFLNkUsS0FBTzNFLFNBQVNDLGNBQWMsVUFDbkNILEtBQUs2RSxLQUFLdkUsVUFBVUMsSUFBSSxVQUN4QixNQUFNaUUsRUFBUXRFLFNBQVNDLGNBQWMsTUFDckNxRSxFQUFNbEUsVUFBVUMsSUFBSSxpQkFDcEJpRSxFQUFNekIsWUFBYyxtQkFDcEIsTUFBTWtDLEVBQU8vRSxTQUFTQyxjQUFjLEtBQ3BDOEUsRUFBSzNFLFVBQVVDLElBQUksZ0JBQ25CMEUsRUFBS2xDLFlBQWMsT0FDbkIsTUFBTW1DLEVBQVEsSUFBSVgsRUFDWlksRUFBUWpGLFNBQVNDLGNBQWMsT0FDckNnRixFQUFNN0UsVUFBVUMsSUFBSSxpQkFDcEJQLEtBQUs2RSxLQUFLckUsT0FBT2dFLEVBQU9TLEVBQU1DLEVBQU1qRixVQUFXa0YsR0FDL0NGLEVBQUt0RSxpQkFBaUIsU0FBUyxLQUM3QnVFLEVBQU1qRixVQUFVSyxVQUFVdUQsT0FBTyx3QkFBdUIsR0FFNUQsRUNsQmEsTUFBTXVCLEVBQ25CckYsY0FDRUMsS0FBSzZFLEtBQU8zRSxTQUFTQyxjQUFjLFVBQ25DSCxLQUFLNkUsS0FBS3ZFLFVBQVVDLElBQUksVUFDeEIsTUFBTXNDLEVBQU8zQyxTQUFTQyxjQUFjLEtBQ3BDMEMsRUFBS3ZDLFVBQVVDLElBQUksZ0JBQ25Cc0MsRUFBS0UsWUFBYyxZQUNuQi9DLEtBQUtxRixJQUFNbkYsU0FBU0MsY0FBYyxRQUNsQ0gsS0FBS3FGLElBQUkvRSxVQUFVQyxJQUFJLGdCQUN2QlAsS0FBS3FGLElBQUl0QyxZQUFjLE9BQ3ZCL0MsS0FBS3NGLE1BQVFwRixTQUFTQyxjQUFjLFFBQ3BDSCxLQUFLc0YsTUFBTWhGLFVBQVVDLElBQUksZ0JBQ3pCUCxLQUFLc0YsTUFBTXZDLFlBQWMsU0FDekJGLEVBQUtyQyxPQUFPUixLQUFLcUYsSUFBS3JGLEtBQUtzRixPQUMzQixNQUFNQyxFQUFXcEIsYUFBYUMsUUFBUSxRQUVwQ3BFLEtBQUtlLEtBREh3RSxHQUVlLE1BQ0QsUUFBZHZGLEtBQUtlLEtBQ1BmLEtBQUtzRixNQUFNaEYsVUFBVUMsSUFBSSx5QkFDcEJQLEtBQUtxRixJQUFJL0UsVUFBVUMsSUFBSSx5QkFDOUIsTUFBTWlGLEVBQU90RixTQUFTQyxjQUFjLEtBQ3BDcUYsRUFBS2xGLFVBQVVDLElBQUksZUFBZ0IsZ0JBQ25DaUYsRUFBS3pDLFlBQWMsT0FDbkIvQyxLQUFLNkUsS0FBS3JFLE9BQU9xQyxFQUFNMkMsRUFDekIsQ0FFQUMsYUFBYTFFLEdBQ1hmLEtBQUtlLEtBQU9BLEVBQ1pmLEtBQUtzRixNQUFNaEYsVUFBVXVELE9BQU8seUJBQzVCN0QsS0FBS3FGLElBQUkvRSxVQUFVdUQsT0FBTyx3QkFDNUIsRUM5QkYsTUFBTTZCLEVBQU94RixTQUFTeUYsY0FBYyxRQUM5QkMsRUFBTSxJQ0VHLE1BQ2I3RixjQUNFQyxLQUFLQyxVQUFZQyxTQUFTQyxjQUFjLE9BQ3hDSCxLQUFLQyxVQUFVSyxVQUFVQyxJQUFJLE9BQzdCLE1BQU1nRixFQUFXcEIsYUFBYUMsUUFBUSxRQUVwQ3BFLEtBQUtlLEtBREh3RSxHQUVlLE1BRW5CLE1BQU1NLEVBQVMsSUFBSWIsRUFDbkJoRixLQUFLOEYsT0FBUyxJQUFJVixFQUVsQnBGLEtBQUsrRixTQUFXLElBQUlqRyxFQUNwQkUsS0FBS2dHLFNBQVcsSUFBSWxDLEVBRXBCOUQsS0FBS0MsVUFBVU8sT0FDYnFGLEVBQU9oQixLQUNQN0UsS0FBSytGLFNBQVM5RixVQUNkRCxLQUFLZ0csU0FBUy9GLFVBQ2RELEtBQUs4RixPQUFPakIsTUFHZDdFLEtBQUtDLFVBQVVVLGlCQUFpQixjQUFjc0QsSUFDNUNqRSxLQUFLaUcsYUFBYWhDLEVBQUVULE9BQU8xQyxPQUFRbUQsRUFBRVQsT0FBT2IsS0FDNUMzQyxLQUFLK0YsU0FBUzNGLE1BQU1rQyxPQUFNLElBRzVCdEMsS0FBS0MsVUFBVVUsaUJBQWlCLGNBQWNzRCxJQUM1Q2pFLEtBQUtjLFFBQVVkLEtBQUtjLE9BQ3BCZCxLQUFLZ0csU0FBUzNCLFlBQVlyRSxLQUFLYyxPQUFRZCxLQUFLZSxNQUM1Q2YsS0FBSytGLFNBQVMzRixNQUFNa0MsT0FBTSxJQUc1QnBDLFNBQVNTLGlCQUFpQixXQUFXMEMsSUFDbkNBLEVBQU02QyxpQkFDTixJQUFJQyxFQUFhbkcsS0FBS2dHLFNBQVNoQyxRQUFRb0MsTUFDckNuQyxHQUFLQSxFQUFFdEIsSUFBSXJCLE9BQVMrQixFQUFNL0IsT0FFVCxlQUFmK0IsRUFBTS9CLE9BQ1I2RSxFQUFhbkcsS0FBS2dHLFNBQVNoQyxRQUFRb0MsTUFBS25DLEdBQW9CLGNBQWZBLEVBQUV0QixJQUFJckIsUUFFakQ2RSxJQUNGQSxFQUFXbEcsVUFBVUssVUFBVUMsSUFBSSwwQkFFaEM4QyxFQUFNZ0QsU0FBV2hELEVBQU1pRCxTQUN2QmpELEVBQU1rRCxVQUEyQixVQUFmbEQsRUFBTS9CLE1BRXpCK0IsRUFBTTZDLGlCQUNObEcsS0FBS3dHLGNBQ0luRCxFQUFNckMsTUFDZnFDLEVBQU02QyxpQkFDTmxHLEtBQUtpRyxhQUFhRSxFQUFXckYsT0FBUXFGLEVBQVd4RCxNQUUvQixhQUFmVSxFQUFNL0IsT0FDUjZFLEVBQVdsRyxVQUFVd0csUUFDckJ6RyxLQUFLaUcsY0FBYSxFQUFNRSxFQUFXeEQsTUFFbEIsY0FBZlUsRUFBTS9CLE1BQXVDLGVBQWYrQixFQUFNL0IsT0FDbEN0QixLQUFLYyxPQUNQZCxLQUFLaUcsY0FBYSxFQUFPRSxFQUFXeEQsS0FFcEMzQyxLQUFLaUcsY0FBYSxFQUFNRSxFQUFXeEQsTUFHekMsSUFHRnpDLFNBQVNTLGlCQUFpQixTQUFTMEMsSUFDakNBLEVBQU02QyxpQkFDTixJQUFJQyxFQUFhbkcsS0FBS2dHLFNBQVNoQyxRQUFRb0MsTUFDckNuQyxHQUFLQSxFQUFFdEIsSUFBSXJCLE9BQVMrQixFQUFNL0IsT0FFVCxlQUFmK0IsRUFBTS9CLE9BQ1I2RSxFQUFhbkcsS0FBS2dHLFNBQVNoQyxRQUFRb0MsTUFBS25DLEdBQW9CLGNBQWZBLEVBQUV0QixJQUFJckIsUUFFakQ2RSxJQUNGQSxFQUFXbEcsVUFBVUssVUFBVXNELE9BQU8sMEJBQ25CLGFBQWZQLEVBQU0vQixPQUNSNkUsRUFBV2xHLFVBQVV3RyxRQUNyQnpHLEtBQUtpRyxjQUFhLEVBQU9FLEVBQVd4RCxNQUVuQixjQUFmVSxFQUFNL0IsTUFBdUMsZUFBZitCLEVBQU0vQixPQUNsQ3RCLEtBQUtjLE9BQ1BkLEtBQUtpRyxjQUFhLEVBQU9FLEVBQVd4RCxLQUMvQjNDLEtBQUtpRyxjQUFhLEVBQU1FLEVBQVd4RCxNQUU5QyxHQUVKLENBRUE2RCxhQUNvQixRQUFkeEcsS0FBS2UsS0FDUGYsS0FBS2UsS0FBTyxLQUNQZixLQUFLZSxLQUFPLE1BQ25CZixLQUFLOEYsT0FBT0wsYUFBYXpGLEtBQUtlLE1BQzlCZixLQUFLZ0csU0FBUzNCLFlBQVlyRSxLQUFLYyxPQUFRZCxLQUFLZSxNQUM1Q29ELGFBQWF1QyxRQUFRLE9BQVExRyxLQUFLZSxLQUNwQyxDQUVBa0YsYUFBYW5GLEVBQVE2QixRQUNKSyxJQUFYbEMsSUFDRmQsS0FBS2MsT0FBU0EsRUFDZGQsS0FBS2dHLFNBQVMzQixZQUFZckUsS0FBS2MsT0FBUWQsS0FBS2UsT0FFOUNmLEtBQUsrRixTQUFTbkYsUUFBUStCLEVBQUszQyxLQUFLYyxPQUFRZCxLQUFLZSxLQUMvQyxHRDFHRjJFLEVBQUtsRixPQUFPb0YsRUFBSTNGLFUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvY29tcG9uZW50cy90ZXh0YXJlYS9pbmRleC5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvY29tcG9uZW50cy9rZXkvaW5kZXguanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMva2V5Ym9hcmQvaW5kZXguanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvaGludHMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvaGVhZGVyL2luZGV4LmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL2Zvb3Rlci9pbmRleC5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2FwcC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgJy4vc3R5bGUuc2NzcydcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgVGV4dGFyZWEge1xuICBjb25zdHJ1Y3RvcigpIHtcbiAgICB0aGlzLmNvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpXG4gICAgdGhpcy5pbnB1dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RleHRhcmVhJylcbiAgICB0aGlzLmlucHV0LnNldEF0dHJpYnV0ZSgnc3BlbGxjaGVjaycsIGZhbHNlKVxuICAgIHRoaXMuaW5wdXQuY2xhc3NMaXN0LmFkZCgndGV4dGFyZWFfX2lucHV0JylcbiAgICB0aGlzLmNvbnRhaW5lci5hcHBlbmQodGhpcy5pbnB1dClcblxuICAgIHRoaXMuY3Vyc29yID0gdGhpcy5pbnB1dC5zZWxlY3Rpb25TdGFydFxuICAgIHRoaXMuaW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICB0aGlzLmN1cnNvciA9IHRoaXMuaW5wdXQuc2VsZWN0aW9uU3RhcnRcbiAgICB9KVxuICB9XG5cbiAgYWRkQ2hhcihrZXlJbmZvLCBpc0NhcHMsIGxhbmcpIHtcbiAgICBpZiAoa2V5SW5mby5rZXkpIHtcbiAgICAgIGxldCBrZXlcbiAgICAgIGlmIChsYW5nID09PSAnZW5nJykge1xuICAgICAgICBpZiAoaXNDYXBzICYmIGtleUluZm8ub25TaGlmdCkge1xuICAgICAgICAgIGtleSA9IGtleUluZm8ub25TaGlmdFxuICAgICAgICB9IGVsc2Uga2V5ID0ga2V5SW5mby5rZXlcbiAgICAgIH0gZWxzZSBpZiAoaXNDYXBzKSB7XG4gICAgICAgIGlmIChrZXlJbmZvLmxhbmdPblNoaWZ0KSB7XG4gICAgICAgICAga2V5ID0ga2V5SW5mby5sYW5nT25TaGlmdFxuICAgICAgICB9IGVsc2UgaWYgKGtleUluZm8ub25TaGlmdCkge1xuICAgICAgICAgIGtleSA9IGtleUluZm8ub25TaGlmdFxuICAgICAgICB9IGVsc2UgaWYgKGtleUluZm8ubGFuZykge1xuICAgICAgICAgIGtleSA9IGtleUluZm8ubGFuZFxuICAgICAgICB9IGVsc2Uga2V5ID0ga2V5SW5mby5rZXlcbiAgICAgIH0gZWxzZSBpZiAoa2V5SW5mby5sYW5nKSB7XG4gICAgICAgIGtleSA9IGtleUluZm8ubGFuZ1xuICAgICAgfSBlbHNlIGtleSA9IGtleUluZm8ua2V5XG5cbiAgICAgIHRoaXMuaW5wdXQudmFsdWUgPVxuICAgICAgICB0aGlzLmlucHV0LnZhbHVlLnNsaWNlKDAsIHRoaXMuY3Vyc29yKSArXG4gICAgICAgIGtleSArXG4gICAgICAgIHRoaXMuaW5wdXQudmFsdWUuc2xpY2UodGhpcy5jdXJzb3IpXG4gICAgICB0aGlzLmN1cnNvciArPSAxXG4gICAgfSBlbHNlIHtcbiAgICAgIGlmIChrZXlJbmZvLmNvZGUgPT09ICdBcnJvd1VwJykge1xuICAgICAgICB0aGlzLnNldEN1cnNvclVwKClcbiAgICAgIH1cbiAgICAgIGlmIChrZXlJbmZvLmNvZGUgPT09ICdBcnJvd0Rvd24nKSB7XG4gICAgICAgIHRoaXMuc2V0Q3Vyc29yRG93bigpXG4gICAgICB9XG5cbiAgICAgIGlmIChrZXlJbmZvLmNvZGUgPT09ICdCYWNrc3BhY2UnKSB7XG4gICAgICAgIHRoaXMuaW5wdXQudmFsdWUgPVxuICAgICAgICAgIHRoaXMuaW5wdXQudmFsdWUuc2xpY2UoMCwgdGhpcy5jdXJzb3IgLSAxKSArXG4gICAgICAgICAgdGhpcy5pbnB1dC52YWx1ZS5zbGljZSh0aGlzLmN1cnNvcilcbiAgICAgICAgdGhpcy5jdXJzb3IgLT0gMVxuICAgICAgfSBlbHNlIGlmIChrZXlJbmZvLmNvZGUgPT09ICdEZWxldGUnKSB7XG4gICAgICAgIHRoaXMuaW5wdXQudmFsdWUgPVxuICAgICAgICAgIHRoaXMuaW5wdXQudmFsdWUuc2xpY2UoMCwgdGhpcy5jdXJzb3IpICtcbiAgICAgICAgICB0aGlzLmlucHV0LnZhbHVlLnNsaWNlKHRoaXMuY3Vyc29yICsgMSlcbiAgICAgIH0gZWxzZSBpZiAoa2V5SW5mby5jb2RlID09PSAnQXJyb3dMZWZ0Jykge1xuICAgICAgICB0aGlzLm1vdmVDdXJzb3IoJ2xlZnQnKVxuICAgICAgfSBlbHNlIGlmIChrZXlJbmZvLmNvZGUgPT09ICdBcnJvd1JpZ2h0Jykge1xuICAgICAgICB0aGlzLm1vdmVDdXJzb3IoJ3JpZ2h0JylcbiAgICAgIH1cbiAgICB9XG5cbiAgICB0aGlzLnNldEZvY3VzKClcbiAgfVxuXG4gIHNldEN1cnNvclVwKCkge1xuICAgIGNvbnN0IGxpbmVTdGFydCA9IHRoaXMuaW5wdXQudmFsdWUubGFzdEluZGV4T2YoJ1xcbicsIHRoaXMuY3Vyc29yIC0gMSlcbiAgICBjb25zdCBnYXAgPSB0aGlzLmN1cnNvciAtIGxpbmVTdGFydFxuICAgIGlmIChnYXAgPj0gOTUgfHwgKGxpbmVTdGFydCA9PT0gLTEgJiYgdGhpcy5pbnB1dC52YWx1ZS5sZW5ndGggPiA5NSkpIHtcbiAgICAgIHRoaXMuY3Vyc29yIC09IDk1XG4gICAgfSBlbHNlIHtcbiAgICAgIGlmIChsaW5lU3RhcnQgPT09IC0xKSB7XG4gICAgICAgIHRoaXMuY3Vyc29yID0gMFxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29uc3QgcHJldkxpbmVTdGFydCA9IHRoaXMuaW5wdXQudmFsdWUubGFzdEluZGV4T2YoJ1xcbicsIGxpbmVTdGFydCAtIDEpXG4gICAgICAgIGNvbnN0IHByZXZMaW5lTGVuZ3RoID0gbGluZVN0YXJ0IC0gcHJldkxpbmVTdGFydFxuICAgICAgICBpZiAocHJldkxpbmVMZW5ndGggPCBnYXApIHtcbiAgICAgICAgICB0aGlzLmN1cnNvciA9IGxpbmVTdGFydFxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMuY3Vyc29yID0gcHJldkxpbmVTdGFydCArIGdhcFxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgdGhpcy5pbnB1dC5zZXRTZWxlY3Rpb25SYW5nZSh0aGlzLmN1cnNvciwgdGhpcy5jdXJzb3IpXG4gIH1cblxuICBzZXRDdXJzb3JEb3duKCkge1xuICAgIGNvbnN0IGxpbmVTdGFydCA9IHRoaXMuaW5wdXQudmFsdWUubGFzdEluZGV4T2YoJ1xcbicsIHRoaXMuY3Vyc29yIC0gMSlcbiAgICBjb25zdCBnYXAgPSB0aGlzLmN1cnNvciAtIGxpbmVTdGFydFxuICAgIGNvbnN0IG5leHRMaW5lU3RhcnQgPSB0aGlzLmlucHV0LnZhbHVlLmluZGV4T2YoJ1xcbicsIGxpbmVTdGFydCArIDEpXG4gICAgaWYgKGdhcCA+PSA5NSB8fCAobGluZVN0YXJ0ID09PSAtMSAmJiB0aGlzLmlucHV0LnZhbHVlLmxlbmd0aCA+IDk1KSkge1xuICAgICAgdGhpcy5jdXJzb3IgKz0gOTVcbiAgICB9IGVsc2UgaWYgKG5leHRMaW5lU3RhcnQgPT09IC0xKSB7XG4gICAgICB0aGlzLmN1cnNvciA9IHRoaXMuaW5wdXQudmFsdWUubGVuZ3RoXG4gICAgfSBlbHNlIHtcbiAgICAgIGxldCBhZnRlck5leHRMaW5lID0gdGhpcy5pbnB1dC52YWx1ZS5pbmRleE9mKCdcXG4nLCBuZXh0TGluZVN0YXJ0ICsgMSlcbiAgICAgIGlmIChhZnRlck5leHRMaW5lID09PSAtMSkge1xuICAgICAgICBhZnRlck5leHRMaW5lID0gdGhpcy5pbnB1dC52YWx1ZS5sZW5ndGhcbiAgICAgIH1cbiAgICAgIGNvbnN0IG5leHRMaW5lTGVuZ3RoID0gYWZ0ZXJOZXh0TGluZSAtIG5leHRMaW5lU3RhcnRcbiAgICAgIGlmIChuZXh0TGluZUxlbmd0aCA8IGdhcCkge1xuICAgICAgICB0aGlzLmN1cnNvciA9IG5leHRMaW5lU3RhcnQgKyBuZXh0TGluZUxlbmd0aFxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5jdXJzb3IgPSBuZXh0TGluZVN0YXJ0ICsgZ2FwXG4gICAgICB9XG4gICAgfVxuXG4gICAgdGhpcy5pbnB1dC5zZXRTZWxlY3Rpb25SYW5nZSh0aGlzLmN1cnNvciwgdGhpcy5jdXJzb3IpXG4gIH1cblxuICBzZXRGb2N1cygpIHtcbiAgICB0aGlzLmlucHV0LmZvY3VzKClcbiAgICB0aGlzLmlucHV0LnNlbGVjdGlvblN0YXJ0ID0gdGhpcy5jdXJzb3JcbiAgICB0aGlzLmlucHV0LnNlbGVjdGlvbkVuZCA9IHRoaXMuY3Vyc29yXG4gIH1cblxuICBtb3ZlQ3Vyc29yKHNpZGUpIHtcbiAgICBpZiAoc2lkZSA9PT0gJ2xlZnQnKSB7XG4gICAgICB0aGlzLmN1cnNvciAtPSAxXG4gICAgfSBlbHNlIHRoaXMuY3Vyc29yICs9IDFcbiAgICB0aGlzLnNldEZvY3VzKClcbiAgfVxufVxuIiwiaW1wb3J0ICcuL3N0eWxlLnNjc3MnXG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEtleSB7XG4gIGNvbnN0cnVjdG9yKGtleU9iaikge1xuICAgIHRoaXMub2JqID0ga2V5T2JqXG4gICAgdGhpcy5jb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKVxuICAgIHRoaXMuY29udGFpbmVyLmNsYXNzTGlzdC5hZGQoJ2tleV9fY29udGFpbmVyJylcbiAgICB0aGlzLmZhY2UgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKVxuICAgIHRoaXMuZmFjZS5jbGFzc0xpc3QuYWRkKCdrZXlfX2ZhY2UnKVxuICAgIHRoaXMudGV4dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKVxuICAgIHRoaXMudGV4dC5jbGFzc0xpc3QuYWRkKCdrZXlfX3RleHQnKVxuICAgIGlmIChrZXlPYmoudHlwZSA9PT0gJ2NoYXInKSB7XG4gICAgICB0aGlzLnRleHQudGV4dENvbnRlbnQgPSBrZXlPYmoua2V5XG4gICAgfSBlbHNlIGlmIChrZXlPYmoubmFtZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICB0aGlzLnRleHQudGV4dENvbnRlbnQgPSBrZXlPYmoubmFtZVxuICAgIH0gZWxzZSB0aGlzLnRleHQudGV4dENvbnRlbnQgPSBrZXlPYmouY29kZVxuICAgIHRoaXMuZmFjZS5hcHBlbmQodGhpcy50ZXh0KVxuICAgIHN3aXRjaCAoa2V5T2JqLnNpemUpIHtcbiAgICAgIGNhc2UgMjpcbiAgICAgICAgdGhpcy5jb250YWluZXIuY2xhc3NMaXN0LmFkZCgna2V5X19jb250YWluZXJfcycpXG4gICAgICAgIGJyZWFrXG4gICAgICBjYXNlIDM6XG4gICAgICAgIHRoaXMuY29udGFpbmVyLmNsYXNzTGlzdC5hZGQoJ2tleV9fY29udGFpbmVyX2V2ZW50X20nKVxuICAgICAgICBicmVha1xuICAgICAgY2FzZSA0OlxuICAgICAgICB0aGlzLmNvbnRhaW5lci5jbGFzc0xpc3QuYWRkKCdrZXlfX2NvbnRhaW5lcl9ldmVudF9sJylcbiAgICAgICAgYnJlYWtcbiAgICAgIGNhc2UgNTpcbiAgICAgICAgdGhpcy5jb250YWluZXIuY2xhc3NMaXN0LmFkZCgna2V5X19jb250YWluZXJfZXZlbnRfeGwnKVxuICAgICAgICBicmVha1xuICAgICAgY2FzZSAxOlxuICAgICAgICB0aGlzLmNvbnRhaW5lci5jbGFzc0xpc3QuYWRkKCdrZXlfX2NvbnRhaW5lcl94cycpXG4gICAgICAgIGJyZWFrXG4gICAgfVxuICAgIHRoaXMuY29udGFpbmVyLmFwcGVuZCh0aGlzLmZhY2UpXG4gICAgaWYgKGtleU9iai50eXBlID09PSAnZXZlbnQnKSB7XG4gICAgICBpZiAoa2V5T2JqLmlzQXJyb3cpIHtcbiAgICAgICAgdGhpcy5jb250YWluZXIuY2xhc3NMaXN0LmFkZCgna2V5X19jb250YWluZXJfYXJyb3cnKVxuICAgICAgfSBlbHNlIHRoaXMuY29udGFpbmVyLmNsYXNzTGlzdC5hZGQoJ2tleV9fY29udGFpbmVyX2V2ZW50JylcbiAgICB9XG5cbiAgICB0aGlzLmNvbnRhaW5lci5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgIGlmIChrZXlPYmouY29kZSA9PT0gJ0NhcHNMb2NrJykge1xuICAgICAgICB0aGlzLnNldE9uTW9kZSgpXG4gICAgICB9XG4gICAgICBjb25zdCBldmVudCA9IG5ldyBDdXN0b21FdmVudCgnY3VzdG9tLWtleScsIHtcbiAgICAgICAgYnViYmxlczogdHJ1ZSxcbiAgICAgICAgZGV0YWlsOiB7IG9iajoga2V5T2JqLCBpc0NhcHM6IHRoaXMuaXNDYXBzIH0sXG4gICAgICB9KVxuICAgICAgdGhpcy5jb250YWluZXIuZGlzcGF0Y2hFdmVudChldmVudClcbiAgICB9KVxuXG4gICAgdGhpcy5jb250YWluZXIuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgKCkgPT4ge1xuICAgICAgdGhpcy5jb250YWluZXIuY2xhc3NMaXN0LmFkZCgna2V5X19jb250YWluZXJfY2xpY2tlZCcpXG4gICAgICB0aGlzLmNvbnRhaW5lci5jbGFzc0xpc3QuYWRkKCdrZXlfX2ZhY2VfY2xpY2tlZCcpXG4gICAgICB0aGlzLnRvZ2dsZVNoaWZ0KGtleU9iailcbiAgICB9KVxuXG4gICAgdGhpcy5jb250YWluZXIuYWRkRXZlbnRMaXN0ZW5lcignbW91c2V1cCcsICgpID0+IHtcbiAgICAgIHRoaXMudG9nZ2xlU2hpZnQoa2V5T2JqKVxuICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgIHRoaXMuY29udGFpbmVyLmNsYXNzTGlzdC5yZW1vdmUoJ2tleV9fY29udGFpbmVyX2NsaWNrZWQnKVxuICAgICAgICB0aGlzLmNvbnRhaW5lci5jbGFzc0xpc3QucmVtb3ZlKCdrZXlfX2ZhY2VfY2xpY2tlZCcpXG4gICAgICB9LCAxMDApXG4gICAgfSlcbiAgfVxuXG4gIHNldE9uTW9kZSgpIHtcbiAgICB0aGlzLmZhY2UuY2xhc3NMaXN0LnRvZ2dsZSgna2V5X19mYWNlX29uJylcbiAgICBpZiAodGhpcy5pc0NhcHMpIHtcbiAgICAgIHRoaXMuaXNDYXBzID0gZmFsc2VcbiAgICB9IGVsc2UgdGhpcy5pc0NhcHMgPSB0cnVlXG4gIH1cblxuICB0b2dnbGVTaGlmdChrZXlPYmopIHtcbiAgICBpZiAoa2V5T2JqLmNvZGUgPT09ICdTaGlmdExlZnQnKSB7XG4gICAgICBjb25zdCBldmVudCA9IG5ldyBDdXN0b21FdmVudCgnc2hpZnQtZG93bicsIHtcbiAgICAgICAgYnViYmxlczogdHJ1ZSxcbiAgICAgICAgZGV0YWlsOiB7IG9iajoga2V5T2JqIH0sXG4gICAgICB9KVxuICAgICAgdGhpcy5jb250YWluZXIuZGlzcGF0Y2hFdmVudChldmVudClcbiAgICB9XG4gIH1cbn1cbiIsImltcG9ydCAnLi9zdHlsZS5zY3NzJ1xuaW1wb3J0IEtleSBmcm9tICcuLi9rZXknXG5pbXBvcnQga2V5cyBmcm9tICcuL2tleXMuanNvbidcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgS2V5Ym9hcmQge1xuICBjb25zdHJ1Y3RvcigpIHtcbiAgICB0aGlzLmNoYXJLZXlzQXJyID0gW11cbiAgICB0aGlzLmtleXNBcnIgPSBbXVxuICAgIHRoaXMuY29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JylcbiAgICB0aGlzLmNvbnRhaW5lci5jbGFzc0xpc3QuYWRkKCdrZXlib2FyZF9fY29udGFpbmVyJylcbiAgICBrZXlzLmZvckVhY2goZSA9PiB7XG4gICAgICBjb25zdCBrZXkgPSBuZXcgS2V5KGUpXG4gICAgICBpZiAoZS50eXBlID09PSAnY2hhcicpIHtcbiAgICAgICAgdGhpcy5jaGFyS2V5c0Fyci5wdXNoKGtleSlcbiAgICAgIH1cbiAgICAgIHRoaXMua2V5c0Fyci5wdXNoKGtleSlcbiAgICAgIHRoaXMuY29udGFpbmVyLmFwcGVuZChrZXkuY29udGFpbmVyKVxuICAgIH0pXG4gICAgY29uc3QgbGFuZyA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdsYW5nJylcbiAgICBpZiAobGFuZyAhPT0gJ2VuZycpIHRoaXMuY2hhbmdlTmFtZXMoZmFsc2UsIGxhbmcpXG4gIH1cblxuICBjaGFuZ2VOYW1lcyhpc0NhcHMsIGxhbmcpIHtcbiAgICB0aGlzLmNoYXJLZXlzQXJyLmZvckVhY2goZSA9PiB7XG4gICAgICBpZiAobGFuZyA9PT0gJ2VuZycpIHtcbiAgICAgICAgaWYgKGlzQ2FwcyAmJiBlLm9iai5vblNoaWZ0KSB7XG4gICAgICAgICAgZS50ZXh0LnRleHRDb250ZW50ID0gZS5vYmoub25TaGlmdFxuICAgICAgICB9IGVsc2UgZS50ZXh0LnRleHRDb250ZW50ID0gZS5vYmoua2V5XG4gICAgICB9IGVsc2UgaWYgKGlzQ2Fwcykge1xuICAgICAgICBpZiAoZS5vYmoubGFuZ09uU2hpZnQpIHtcbiAgICAgICAgICBlLnRleHQudGV4dENvbnRlbnQgPSBlLm9iai5sYW5nT25TaGlmdFxuICAgICAgICB9IGVsc2UgZS50ZXh0LnRleHRDb250ZW50ID0gZS5vYmoub25TaGlmdFxuICAgICAgfSBlbHNlIGlmIChlLm9iai5sYW5nKSB7XG4gICAgICAgIGUudGV4dC50ZXh0Q29udGVudCA9IGUub2JqLmxhbmdcbiAgICAgIH0gZWxzZSBlLnRleHQudGV4dENvbnRlbnQgPSBlLm9iai5rZXlcbiAgICB9KVxuICB9XG59XG4iLCJpbXBvcnQgJy4vc3R5bGUuc2NzcydcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgSGludHMge1xuICBjb25zdHJ1Y3RvcigpIHtcbiAgICB0aGlzLmNvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2FzaWRlJylcbiAgICB0aGlzLmNvbnRhaW5lci5jbGFzc0xpc3QuYWRkKCdoaW50c19fY29udGFpbmVyJylcbiAgICBjb25zdCB0aXRsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2gyJylcbiAgICB0aXRsZS5jbGFzc0xpc3QuYWRkKCdoaW50c19fdGl0bGUnKVxuICAgIHRpdGxlLnRleHRDb250ZW50ID0gJ0hvdCBLZXlzJ1xuICAgIHRoaXMubGlzdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3VsJylcbiAgICB0aGlzLmxpc3QudGV4dENvbnRlbnQgPSAnQ2hhbmdlIGxhbmd1YWdlOidcbiAgICB0aGlzLmxpc3QuY2xhc3NMaXN0LmFkZCgnaGludHNfX2xpc3QnKVxuICAgIHRoaXMuY3JlYXRlTGlzdEl0ZW0oJ0ZvciBNYWM6ICcsICdDb250cm9sICsg4oyYIENvbW1hbmQnKVxuICAgIHRoaXMuY3JlYXRlTGlzdEl0ZW0oJ0ZvciBXaW5kb3dzOiAnLCAn4oenIFNoaWZ0ICsg4o61IFNwYWNlJylcbiAgICBjb25zdCB0ZXh0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpXG4gICAgdGV4dC5jbGFzc0xpc3QuYWRkKCdoaW50c19fdGV4dCcpXG4gICAgdGV4dC50ZXh0Q29udGVudCA9ICdLZXlib2FyZCB3YXMgbWFkZSBvbiBNYWMgT1MnXG4gICAgdGhpcy5jb250YWluZXIuYXBwZW5kKHRpdGxlLCB0aGlzLmxpc3QsIHRleHQpXG4gIH1cblxuICBjcmVhdGVMaXN0SXRlbShmaXJzdFRleHQsIHNlY29uZFRleHQpIHtcbiAgICBjb25zdCBpdGVtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGknKVxuICAgIGl0ZW0uY2xhc3NMaXN0LmFkZCgnaGludHNfX2l0ZW0nKVxuICAgIGNvbnN0IHNwYW4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJylcbiAgICBzcGFuLmNsYXNzTGlzdC5hZGQoJ2hpbnRzX19zcGFuJylcbiAgICBzcGFuLnRleHRDb250ZW50ID0gZmlyc3RUZXh0XG4gICAgY29uc3QgdGV4dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKVxuICAgIHRleHQudGV4dENvbnRlbnQgPSBzZWNvbmRUZXh0XG4gICAgaXRlbS5hcHBlbmQodGV4dClcbiAgICB0ZXh0LnByZXBlbmQoc3BhbilcbiAgICB0aGlzLmxpc3QuYXBwZW5kKGl0ZW0pXG4gIH1cbn1cbiIsImltcG9ydCAnLi9zdHlsZS5zY3NzJ1xuaW1wb3J0IEhpbnRzIGZyb20gJy4uL2hpbnRzJ1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBIZWFkZXIge1xuICBjb25zdHJ1Y3RvcigpIHtcbiAgICB0aGlzLml0ZW0gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdoZWFkZXInKVxuICAgIHRoaXMuaXRlbS5jbGFzc0xpc3QuYWRkKCdoZWFkZXInKVxuICAgIGNvbnN0IHRpdGxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaDEnKVxuICAgIHRpdGxlLmNsYXNzTGlzdC5hZGQoJ2hlYWRlcl9fdGl0bGUnKVxuICAgIHRpdGxlLnRleHRDb250ZW50ID0gJ1ZpcnR1YWwgS2V5Ym9hcmQnXG4gICAgY29uc3Qgbm90ZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKVxuICAgIG5vdGUuY2xhc3NMaXN0LmFkZCgnaGVhZGVyX19ub3RlJylcbiAgICBub3RlLnRleHRDb250ZW50ID0gJ0luZm8nXG4gICAgY29uc3QgaGludHMgPSBuZXcgSGludHMoKVxuICAgIGNvbnN0IGNvdmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JylcbiAgICBjb3Zlci5jbGFzc0xpc3QuYWRkKCdoZWFkZXJfX2NvdmVyJylcbiAgICB0aGlzLml0ZW0uYXBwZW5kKHRpdGxlLCBub3RlLCBoaW50cy5jb250YWluZXIsIGNvdmVyKVxuICAgIG5vdGUuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICBoaW50cy5jb250YWluZXIuY2xhc3NMaXN0LnRvZ2dsZSgnaGludHNfX2NvbnRhaW5lcl9vcGVuJylcbiAgICB9KVxuICB9XG59XG4iLCJpbXBvcnQgJy4vc3R5bGUuc2NzcydcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgRm9vdGVyIHtcbiAgY29uc3RydWN0b3IoKSB7XG4gICAgdGhpcy5pdGVtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZm9vdGVyJylcbiAgICB0aGlzLml0ZW0uY2xhc3NMaXN0LmFkZCgnZm9vdGVyJylcbiAgICBjb25zdCB0ZXh0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpXG4gICAgdGV4dC5jbGFzc0xpc3QuYWRkKCdmb290ZXJfX3RleHQnKVxuICAgIHRleHQudGV4dENvbnRlbnQgPSAnTGF5b3V0OiAgJ1xuICAgIHRoaXMuZW5nID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpXG4gICAgdGhpcy5lbmcuY2xhc3NMaXN0LmFkZCgnZm9vdGVyX19zcGFuJylcbiAgICB0aGlzLmVuZy50ZXh0Q29udGVudCA9ICdlbmcgJ1xuICAgIHRoaXMuY3JvYXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJylcbiAgICB0aGlzLmNyb2F0LmNsYXNzTGlzdC5hZGQoJ2Zvb3Rlcl9fc3BhbicpXG4gICAgdGhpcy5jcm9hdC50ZXh0Q29udGVudCA9ICdIUi9TUkInXG4gICAgdGV4dC5hcHBlbmQodGhpcy5lbmcsIHRoaXMuY3JvYXQpXG4gICAgY29uc3QgcHJldkxhbmcgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnbGFuZycpXG4gICAgaWYgKHByZXZMYW5nKSB7XG4gICAgICB0aGlzLmxhbmcgPSBwcmV2TGFuZ1xuICAgIH0gZWxzZSB0aGlzLmxhbmcgPSAnZW5nJ1xuICAgIGlmICh0aGlzLmxhbmcgIT09ICdlbmcnKSB7XG4gICAgICB0aGlzLmNyb2F0LmNsYXNzTGlzdC5hZGQoJ2Zvb3Rlcl9fc3Bhbl9zZWxlY3RlZCcpXG4gICAgfSBlbHNlIHRoaXMuZW5nLmNsYXNzTGlzdC5hZGQoJ2Zvb3Rlcl9fc3Bhbl9zZWxlY3RlZCcpXG4gICAgY29uc3QgZGF0ZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKVxuICAgIGRhdGUuY2xhc3NMaXN0LmFkZCgnZm9vdGVyX190ZXh0JywgJ2Zvb3Rlcl9fbGluaycpXG4gICAgZGF0ZS50ZXh0Q29udGVudCA9ICcyMDIzJ1xuICAgIHRoaXMuaXRlbS5hcHBlbmQodGV4dCwgZGF0ZSlcbiAgfVxuXG4gIG9uTGFuZ0NoYW5nZShsYW5nKSB7XG4gICAgdGhpcy5sYW5nID0gbGFuZ1xuICAgIHRoaXMuY3JvYXQuY2xhc3NMaXN0LnRvZ2dsZSgnZm9vdGVyX19zcGFuX3NlbGVjdGVkJylcbiAgICB0aGlzLmVuZy5jbGFzc0xpc3QudG9nZ2xlKCdmb290ZXJfX3NwYW5fc2VsZWN0ZWQnKVxuICB9XG59XG4iLCJpbXBvcnQgJy4vc3R5bGUuc2NzcydcbmltcG9ydCBBcHAgZnJvbSAnLi9hcHAnXG5cbmNvbnN0IHJvb3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdib2R5JylcbmNvbnN0IGFwcCA9IG5ldyBBcHAoKVxucm9vdC5hcHBlbmQoYXBwLmNvbnRhaW5lcilcbiIsImltcG9ydCAnLi9zdHlsZS5zY3NzJ1xuaW1wb3J0IFRleHRhcmVhIGZyb20gJy4vY29tcG9uZW50cy90ZXh0YXJlYSdcbmltcG9ydCBLZXlib2FyZCBmcm9tICcuL2NvbXBvbmVudHMva2V5Ym9hcmQnXG5pbXBvcnQgSGVhZGVyIGZyb20gJy4vY29tcG9uZW50cy9oZWFkZXInXG5pbXBvcnQgRm9vdGVyIGZyb20gJy4vY29tcG9uZW50cy9mb290ZXInXG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEFwcCB7XG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHRoaXMuY29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JylcbiAgICB0aGlzLmNvbnRhaW5lci5jbGFzc0xpc3QuYWRkKCdhcHAnKVxuICAgIGNvbnN0IHByZXZMYW5nID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2xhbmcnKVxuICAgIGlmIChwcmV2TGFuZykge1xuICAgICAgdGhpcy5sYW5nID0gcHJldkxhbmdcbiAgICB9IGVsc2UgdGhpcy5sYW5nID0gJ2VuZydcblxuICAgIGNvbnN0IGhlYWRlciA9IG5ldyBIZWFkZXIoKVxuICAgIHRoaXMuZm9vdGVyID0gbmV3IEZvb3RlcigpXG5cbiAgICB0aGlzLnRleHRhcmVhID0gbmV3IFRleHRhcmVhKClcbiAgICB0aGlzLmtleWJvYXJkID0gbmV3IEtleWJvYXJkKClcblxuICAgIHRoaXMuY29udGFpbmVyLmFwcGVuZChcbiAgICAgIGhlYWRlci5pdGVtLFxuICAgICAgdGhpcy50ZXh0YXJlYS5jb250YWluZXIsXG4gICAgICB0aGlzLmtleWJvYXJkLmNvbnRhaW5lcixcbiAgICAgIHRoaXMuZm9vdGVyLml0ZW1cbiAgICApXG5cbiAgICB0aGlzLmNvbnRhaW5lci5hZGRFdmVudExpc3RlbmVyKCdjdXN0b20ta2V5JywgZSA9PiB7XG4gICAgICB0aGlzLm9uVmlydHVhbEtleShlLmRldGFpbC5pc0NhcHMsIGUuZGV0YWlsLm9iailcbiAgICAgIHRoaXMudGV4dGFyZWEuaW5wdXQuZm9jdXMoKVxuICAgIH0pXG5cbiAgICB0aGlzLmNvbnRhaW5lci5hZGRFdmVudExpc3RlbmVyKCdzaGlmdC1kb3duJywgZSA9PiB7XG4gICAgICB0aGlzLmlzQ2FwcyA9ICF0aGlzLmlzQ2Fwc1xuICAgICAgdGhpcy5rZXlib2FyZC5jaGFuZ2VOYW1lcyh0aGlzLmlzQ2FwcywgdGhpcy5sYW5nKVxuICAgICAgdGhpcy50ZXh0YXJlYS5pbnB1dC5mb2N1cygpXG4gICAgfSlcblxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBldmVudCA9PiB7XG4gICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgbGV0IHZpcnR1YWxLZXkgPSB0aGlzLmtleWJvYXJkLmtleXNBcnIuZmluZChcbiAgICAgICAgZSA9PiBlLm9iai5jb2RlID09PSBldmVudC5jb2RlXG4gICAgICApXG4gICAgICBpZiAoZXZlbnQuY29kZSA9PT0gJ1NoaWZ0UmlnaHQnKSB7XG4gICAgICAgIHZpcnR1YWxLZXkgPSB0aGlzLmtleWJvYXJkLmtleXNBcnIuZmluZChlID0+IGUub2JqLmNvZGUgPT09ICdTaGlmdExlZnQnKVxuICAgICAgfVxuICAgICAgaWYgKHZpcnR1YWxLZXkpIHtcbiAgICAgICAgdmlydHVhbEtleS5jb250YWluZXIuY2xhc3NMaXN0LmFkZCgna2V5X19jb250YWluZXJfY2xpY2tlZCcpXG4gICAgICAgIGlmIChcbiAgICAgICAgICAoZXZlbnQuY3RybEtleSAmJiBldmVudC5tZXRhS2V5KSB8fFxuICAgICAgICAgIChldmVudC5zaGlmdEtleSAmJiBldmVudC5jb2RlID09PSAnU3BhY2UnKVxuICAgICAgICApIHtcbiAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpXG4gICAgICAgICAgdGhpcy5jaGFuZ2VMYW5nKClcbiAgICAgICAgfSBlbHNlIGlmIChldmVudC5rZXkpIHtcbiAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpXG4gICAgICAgICAgdGhpcy5vblZpcnR1YWxLZXkodmlydHVhbEtleS5pc0NhcHMsIHZpcnR1YWxLZXkub2JqKVxuICAgICAgICB9XG4gICAgICAgIGlmIChldmVudC5jb2RlID09PSAnQ2Fwc0xvY2snKSB7XG4gICAgICAgICAgdmlydHVhbEtleS5jb250YWluZXIuY2xpY2soKVxuICAgICAgICAgIHRoaXMub25WaXJ0dWFsS2V5KHRydWUsIHZpcnR1YWxLZXkub2JqKVxuICAgICAgICB9XG4gICAgICAgIGlmIChldmVudC5jb2RlID09PSAnU2hpZnRMZWZ0JyB8fCBldmVudC5jb2RlID09PSAnU2hpZnRSaWdodCcpIHtcbiAgICAgICAgICBpZiAodGhpcy5pc0NhcHMpIHtcbiAgICAgICAgICAgIHRoaXMub25WaXJ0dWFsS2V5KGZhbHNlLCB2aXJ0dWFsS2V5Lm9iailcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5vblZpcnR1YWxLZXkodHJ1ZSwgdmlydHVhbEtleS5vYmopXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfSlcblxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleXVwJywgZXZlbnQgPT4ge1xuICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgIGxldCB2aXJ0dWFsS2V5ID0gdGhpcy5rZXlib2FyZC5rZXlzQXJyLmZpbmQoXG4gICAgICAgIGUgPT4gZS5vYmouY29kZSA9PT0gZXZlbnQuY29kZVxuICAgICAgKVxuICAgICAgaWYgKGV2ZW50LmNvZGUgPT09ICdTaGlmdFJpZ2h0Jykge1xuICAgICAgICB2aXJ0dWFsS2V5ID0gdGhpcy5rZXlib2FyZC5rZXlzQXJyLmZpbmQoZSA9PiBlLm9iai5jb2RlID09PSAnU2hpZnRMZWZ0JylcbiAgICAgIH1cbiAgICAgIGlmICh2aXJ0dWFsS2V5KSB7XG4gICAgICAgIHZpcnR1YWxLZXkuY29udGFpbmVyLmNsYXNzTGlzdC5yZW1vdmUoJ2tleV9fY29udGFpbmVyX2NsaWNrZWQnKVxuICAgICAgICBpZiAoZXZlbnQuY29kZSA9PT0gJ0NhcHNMb2NrJykge1xuICAgICAgICAgIHZpcnR1YWxLZXkuY29udGFpbmVyLmNsaWNrKClcbiAgICAgICAgICB0aGlzLm9uVmlydHVhbEtleShmYWxzZSwgdmlydHVhbEtleS5vYmopXG4gICAgICAgIH1cbiAgICAgICAgaWYgKGV2ZW50LmNvZGUgPT09ICdTaGlmdExlZnQnIHx8IGV2ZW50LmNvZGUgPT09ICdTaGlmdFJpZ2h0Jykge1xuICAgICAgICAgIGlmICh0aGlzLmlzQ2Fwcykge1xuICAgICAgICAgICAgdGhpcy5vblZpcnR1YWxLZXkoZmFsc2UsIHZpcnR1YWxLZXkub2JqKVxuICAgICAgICAgIH0gZWxzZSB0aGlzLm9uVmlydHVhbEtleSh0cnVlLCB2aXJ0dWFsS2V5Lm9iailcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pXG4gIH1cblxuICBjaGFuZ2VMYW5nKCkge1xuICAgIGlmICh0aGlzLmxhbmcgPT09ICdlbmcnKSB7XG4gICAgICB0aGlzLmxhbmcgPSAnaHInXG4gICAgfSBlbHNlIHRoaXMubGFuZyA9ICdlbmcnXG4gICAgdGhpcy5mb290ZXIub25MYW5nQ2hhbmdlKHRoaXMubGFuZylcbiAgICB0aGlzLmtleWJvYXJkLmNoYW5nZU5hbWVzKHRoaXMuaXNDYXBzLCB0aGlzLmxhbmcpXG4gICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2xhbmcnLCB0aGlzLmxhbmcpXG4gIH1cblxuICBvblZpcnR1YWxLZXkoaXNDYXBzLCBvYmopIHtcbiAgICBpZiAoaXNDYXBzICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIHRoaXMuaXNDYXBzID0gaXNDYXBzXG4gICAgICB0aGlzLmtleWJvYXJkLmNoYW5nZU5hbWVzKHRoaXMuaXNDYXBzLCB0aGlzLmxhbmcpXG4gICAgfVxuICAgIHRoaXMudGV4dGFyZWEuYWRkQ2hhcihvYmosIHRoaXMuaXNDYXBzLCB0aGlzLmxhbmcpXG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJUZXh0YXJlYSIsImNvbnN0cnVjdG9yIiwidGhpcyIsImNvbnRhaW5lciIsImRvY3VtZW50IiwiY3JlYXRlRWxlbWVudCIsImlucHV0Iiwic2V0QXR0cmlidXRlIiwiY2xhc3NMaXN0IiwiYWRkIiwiYXBwZW5kIiwiY3Vyc29yIiwic2VsZWN0aW9uU3RhcnQiLCJhZGRFdmVudExpc3RlbmVyIiwiYWRkQ2hhciIsImtleUluZm8iLCJpc0NhcHMiLCJsYW5nIiwia2V5Iiwib25TaGlmdCIsImxhbmdPblNoaWZ0IiwibGFuZCIsInZhbHVlIiwic2xpY2UiLCJjb2RlIiwic2V0Q3Vyc29yVXAiLCJzZXRDdXJzb3JEb3duIiwibW92ZUN1cnNvciIsInNldEZvY3VzIiwibGluZVN0YXJ0IiwibGFzdEluZGV4T2YiLCJnYXAiLCJsZW5ndGgiLCJwcmV2TGluZVN0YXJ0IiwicHJldkxpbmVMZW5ndGgiLCJzZXRTZWxlY3Rpb25SYW5nZSIsIm5leHRMaW5lU3RhcnQiLCJpbmRleE9mIiwiYWZ0ZXJOZXh0TGluZSIsIm5leHRMaW5lTGVuZ3RoIiwiZm9jdXMiLCJzZWxlY3Rpb25FbmQiLCJzaWRlIiwiS2V5Iiwia2V5T2JqIiwib2JqIiwiZmFjZSIsInRleHQiLCJ0eXBlIiwidGV4dENvbnRlbnQiLCJ1bmRlZmluZWQiLCJuYW1lIiwic2l6ZSIsImlzQXJyb3ciLCJzZXRPbk1vZGUiLCJldmVudCIsIkN1c3RvbUV2ZW50IiwiYnViYmxlcyIsImRldGFpbCIsImRpc3BhdGNoRXZlbnQiLCJ0b2dnbGVTaGlmdCIsInNldFRpbWVvdXQiLCJyZW1vdmUiLCJ0b2dnbGUiLCJLZXlib2FyZCIsImNoYXJLZXlzQXJyIiwia2V5c0FyciIsImUiLCJwdXNoIiwibG9jYWxTdG9yYWdlIiwiZ2V0SXRlbSIsImNoYW5nZU5hbWVzIiwiZm9yRWFjaCIsIkhpbnRzIiwidGl0bGUiLCJsaXN0IiwiY3JlYXRlTGlzdEl0ZW0iLCJmaXJzdFRleHQiLCJzZWNvbmRUZXh0IiwiaXRlbSIsInNwYW4iLCJwcmVwZW5kIiwiSGVhZGVyIiwibm90ZSIsImhpbnRzIiwiY292ZXIiLCJGb290ZXIiLCJlbmciLCJjcm9hdCIsInByZXZMYW5nIiwiZGF0ZSIsIm9uTGFuZ0NoYW5nZSIsInJvb3QiLCJxdWVyeVNlbGVjdG9yIiwiYXBwIiwiaGVhZGVyIiwiZm9vdGVyIiwidGV4dGFyZWEiLCJrZXlib2FyZCIsIm9uVmlydHVhbEtleSIsInByZXZlbnREZWZhdWx0IiwidmlydHVhbEtleSIsImZpbmQiLCJjdHJsS2V5IiwibWV0YUtleSIsInNoaWZ0S2V5IiwiY2hhbmdlTGFuZyIsImNsaWNrIiwic2V0SXRlbSJdLCJzb3VyY2VSb290IjoiIn0=